---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: cilium
  namespace: kube-system
spec:
  interval: 5m
  chart:
    spec:
      # renovate: registryUrl=https://helm.traefik.io/traefik
      chart: cilium
      version: 1.10.4
      sourceRef:
        kind: HelmRepository
        name: traefik-charts
        namespace: flux-system
      interval: 5m
  values:
    image:
      repository: quay.io/cilium/cilium
      tag: v1.10.4
      pullPolicy: IfNotPresent
      digest: "sha256:7d354052ccf2a7445101d78cebd14444c7c40129ce7889f2f04b89374dbf8a1d"
      useDigest: true

    autoDirectNodeRoutes: true
    k8sServiceHost: 10.10.0.10
    k8sServicePort: 6443

    rollOutCiliumPods: true

    bgp:
      enabled: true
      announce:
        loadbalancerIP: true

    containerRuntime:
      integration: containerd
      socketPath: /var/run/k3s/containerd/containerd.sock
